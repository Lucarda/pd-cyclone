considerably updated and rewritten codes have their original sources here
